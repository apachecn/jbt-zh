# 10F é«˜çº§ WebDriver â€“ æˆªå±

> åŸæ–‡ï¼š [https://javabeginnerstutorial.com/selenium/10f-advanced-webdriver-taking-screenshot/](https://javabeginnerstutorial.com/selenium/10f-advanced-webdriver-taking-screenshot/)

å—¨å† å†›ï¼ å±å¹•æˆªå›¾ã€‚ åœ¨è½¯ä»¶æµ‹è¯•çš„æ‹¥æŒ¤è¡—é“ä¸Šï¼Œå¦ä¸€ä¸ªç»å¸¸å¬åˆ°çš„æœ¯è¯­ã€‚ å¦‚æœæ‚¨çš„ç¯å¢ƒä¸­å‡ºç°é”™è¯¯ï¼Œè€Œå¼€å‘ä¸­æ²¡æœ‰é”™è¯¯ï¼Œåˆ™æ— æ³•ç”¨æˆªå›¾æ¥è¯æ˜ï¼Œè¿™æ˜¯ä¸€ä¸ªå¥½æµ‹è¯•ï¼ å› æ­¤ï¼Œç°åœ¨æ˜¯æ—¶å€™è¯¥äº†è§£å¦‚ä½•ä½¿ç”¨ Selenium WebDriver æ¥æŠ“å–äº†ã€‚

æˆ‘çŸ¥é“æ‚¨æƒ³åˆ°äº†å‡ ä¸ªé—®é¢˜ã€‚ æœ€é‡è¦çš„æ˜¯ï¼Œâ€œå¦‚æœæ˜¯æ‰‹åŠ¨æµ‹è¯•ï¼Œé‚£ä¹ˆæˆ‘åªè¦æŒ‰ä¸€ä¸‹é”®ç›˜ä¸Šçš„`PrntScr`æŒ‰é’®ï¼Œç„¶åæŠ“å–ä¸€ä¸ªæ¼‚äº®çš„å±å¹•æˆªå›¾å³å¯ã€‚ ä½†æ˜¯ï¼Œå½“æˆ‘å®ç°è‡ªåŠ¨åŒ–æ—¶ï¼Œå¦‚ä½•è·å¾—ç›¸åŒçš„ç»“æœï¼Ÿâ€

çŒœçŒœçœ‹ï¼Œè¿™å¾ˆç®€å•ï¼ åªéœ€æŒ‰ç…§ 3 ä¸ªæ­¥éª¤è¿›è¡Œæ“ä½œï¼Œæ‚¨å°±å¯ä»¥ä½¿ç”¨å±å¹•æˆªå›¾ã€‚ å¦‚æœæ‚¨åƒæˆ‘ä¸€æ ·ï¼Œå¯èƒ½ä¼šæ€¥åˆ‡åœ°æƒ³çœ‹çœ‹å®ƒåœ¨ä»£ç ä¸­æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚ æˆ‘çš„ç›®æ ‡æ˜¯å–æ‚¦ï¼Œæ‰€ä»¥è¯·ä¸è¦å†æ‹–å»¶â€¦â€¦

## æ­¥éª¤ 1ï¼š

ä½¿ç”¨ Selenium WebDriver æä¾›çš„`TakesScreenshot`æ¥å£ã€‚ å°† WebDriver å¯¹è±¡å¼ºåˆ¶è½¬æ¢ä¸º`TakesScreenshot`ç±»å‹ã€‚

å½“æ‚¨åœ¨`TakesScreenshot`ä¸‹é¢çœ‹åˆ°ä¸€æ¡å¼¯æ›²çš„çº¿æ—¶ï¼Œåªéœ€å•å‡»`import org.openqa.selenium.TakesScreenshot;`åŒ…ï¼Œæ‚¨å°†æ²¡æœ‰ä»»ä½•é”™è¯¯ã€‚

```java
// Cast driver object to TakesScreenshot
TakesScreenshot screenshot = (TakesScreenshot) driver;
```

## æ­¥éª¤ 2ï¼š

è¦å°†å±å¹•æˆªå›¾è·å–ä¸ºå›¾åƒæ–‡ä»¶ï¼Œè¯·è°ƒç”¨â€œ`getScreenshotAs`â€æ–¹æ³•ã€‚

æ³¢æµªçº¿ï¼Ÿ - ç‚¹å‡»ï¼š

```java
import org.openqa.selenium.OutputType;
import java.io.File;
```

```java
// Get the screenshot as an image File
File src = screenshot.getScreenshotAs(OutputType.FILE);
```

## æ­¥éª¤ 3ï¼š

å°†ç”Ÿæˆçš„å›¾åƒæ–‡ä»¶å¤åˆ¶åˆ°æ‚¨é€‰æ‹©çš„ç›®æ ‡ä½ç½®ã€‚ ä½¿ç”¨`FileUtils`ç±»çš„`copyFile`æ–¹æ³•å¯ä»¥è½»æ¾å®Œæˆæ­¤æ“ä½œã€‚ é‡è¦çš„æ˜¯è¦æ³¨æ„ï¼Œæ­¤æ–¹æ³•å°†å¼•å‘`IOException`ã€‚ å› æ­¤ï¼Œä½œä¸ºä¸€ç§å¥½ä¹ æƒ¯ï¼Œè¯·å°†è¿™æ®µä»£ç åŒ…è£…åœ¨`try-catch`å—ä¸­ã€‚

çº¿æ¡æ›´å¼¯æ›²ï¼Ÿ - ç‚¹å‡»ï¼š

```java
import java.io.IOException;
import org.apache.commons.io.FileUtils;
import java.text.SimpleDateFormat;
import java.util.Date;
```

ç¡®ä¿å®Œå…¨æŒ‰ç…§æŒ‡å®šçš„æ–¹å¼å¯¼å…¥åŒ…ã€‚ é€šå¸¸ï¼Œæ‚¨å¯èƒ½éœ€è¦ä¸‹è½½`org.apache.commons.io` jarï¼ˆåœ¨æ’°å†™æœ¬æ–‡æ—¶ä¸º[ä¸‹è½½ä½ç½®](https://jar-download.com/explore-java-source-code.php?a=commons-io&g=commons-io&v=2.5&downloadable=1)ï¼‰å¹¶å°†å…¶æ·»åŠ åˆ°é¡¹ç›®çš„æ„å»ºè·¯å¾„ä¸­ã€‚ ä¹‹å‰ï¼Œæˆ‘ä»¬å·²ç»å¤šæ¬¡çœ‹åˆ°æ­¤è¿‡ç¨‹ï¼Œå› æ­¤ï¼Œæˆ‘ä¸å†é‡å¤ï¼ˆè¯·å‚é˜…[æœ¬æ–‡ç¬¬ 3 æ­¥](https://javabeginnerstutorial.com/selenium/9b-webdriver-eclipse-setup/)ï¼‰ã€‚

å¦å¤–ï¼Œè¯·æ³¨æ„ï¼Œæˆ‘ä»¬åœ¨ä»£ç ä¸­å°†å›¾åƒå¦å­˜ä¸º`.jpg`æ–‡ä»¶ã€‚ ä¹Ÿå¯ä»¥å°†å…¶å¦å­˜ä¸º`.png`æ–‡ä»¶ã€‚

å®ƒå¯ä»¥å¾ˆç®€å•ï¼Œ

```java
// Copy the screenshot to destination
FileUtils.copyFile(src, new File(â€œ\\screenshot\\test.jpgâ€));
```

è¿˜æ˜¯ä¸€æ ·å¤æ‚

```java
try {
    // Specify the destination where the image will be saved
    File dest = new File("\\Selenium\\screenshots\\" + testCaseName + "_" + timestamp() + ".jpg");
    // Copy the screenshot to destination
    FileUtils.copyFile(src, dest);
} catch (IOException ex) {
    System.out.println(ex.getMessage());
}

public static String timestamp() {
    // Timestamp to make each screenshot name unique
    return new SimpleDateFormat("yyyy-MM-dd HH-mm-ss").format(new Date());
}
```

åœ¨æˆ‘ä»¬çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨å¤æ‚çš„ç‰ˆæœ¬ã€‚ å› ä¸ºæˆ‘ä»¬è¦å°†æ‰€æœ‰ä¸å±å¹•å¿«ç…§ç›¸å…³çš„ä»£ç æ”¾åœ¨ä¸€ä¸ªå•ç‹¬çš„æ–¹æ³•ä¸­ï¼ˆåœ¨æ–°ç±»ä¸­ï¼‰ï¼Œå¹¶åœ¨æ¯æ¬¡æˆ‘ä»¬å¸Œæœ›æ•è·å±å¹•å¿«ç…§æ—¶è°ƒç”¨å®ƒã€‚ å¦åˆ™ï¼Œæˆ‘ä»¬å°†ä¸å¾—ä¸ä¸ºæ¯ç§æƒ…å†µåšç›¸åŒçš„æ­Œèˆã€‚

## æ¦‚è§ˆ

ä½¿ç”¨ä¸¤ç§æ–¹æ³•åˆ›å»ºä¸€ä¸ªåä¸ºâ€œ`SaveScreenshot.java`â€çš„æ–°ç±»ã€‚

1.  `public static void capture(String testCaseName, WebDriver driver)` â€“ å…·æœ‰æ•è·å±å¹•å¿«ç…§å¹¶å°†å…¶ä¿å­˜åˆ°æ‰€éœ€ä½ç½®çš„æ‰€æœ‰ä»£ç ã€‚
2.  `public static String timestamp()` â€“ ç”¨äºç”Ÿæˆæ—¶é—´æˆ³å¹¶å°†å…¶æä¾›ç»™ä¸Šè¿°æ–¹æ³•ï¼Œä»¥ä½¿æ¯ä¸ªä¿å­˜çš„å±å¹•æˆªå›¾éƒ½æ˜¯å”¯ä¸€çš„ã€‚

## ç¤ºä¾‹åœºæ™¯

1.  æ‰“å¼€ Firefox æµè§ˆå™¨ã€‚
2.  å¯¼èˆªåˆ° Google å¸æˆ·åˆ›å»ºé¡µé¢
3.  é€šè¿‡ ID æ‰¾åˆ°åå­—æ–‡æœ¬æ¡†
4.  è¾“å…¥â€œ`fname01`â€ä½œä¸ºåå­—
5.  æŒ‰åç§°æ‰¾åˆ°å§“æ°æ–‡æœ¬æ¡†
6.  è¾“å…¥â€œ`lname01`â€ä½œä¸ºå§“æ°
7.  æˆªå–é¡µé¢æˆªå›¾å¹¶å°†å…¶ä¿å­˜åˆ°æŸä¸ªä½ç½®ã€‚

## JUnit ä»£ç ï¼š

1.  ### `SaveScreenshot.java`ç±»

```java
package com.blog.junitTests;

import java.io.File;
import java.io.IOException;
import java.text.SimpleDateFormat;
import java.util.Date;

import org.apache.commons.io.FileUtils;
import org.openqa.selenium.OutputType;
import org.openqa.selenium.TakesScreenshot;
import org.openqa.selenium.WebDriver;

public class SaveScreenshot {

  public static void capture(String testCaseName, WebDriver driver) {
    // Cast driver object to TakesScreenshot
    TakesScreenshot screenshot = (TakesScreenshot) driver;
    // Get the screenshot as an image File
    File src = screenshot.getScreenshotAs(OutputType.FILE);
    try {
      // Specify the destination where the image will be saved
      File dest = new File("\\Selenium\\screenshots\\" + testCaseName + "_" + timestamp() + ".jpg");
      // Copy the screenshot to destination
      FileUtils.copyFile(src, dest);
    } catch (IOException ex) {
      System.out.println(ex.getMessage());
    }
  }

  public static String timestamp() {
    // Timestamp to make each screenshot name unique
    return new SimpleDateFormat("yyyy-MM-dd HH-mm-ss").format(new Date());
  }

}
```

### 2\. `Screenshot.java`ç±»ï¼ˆæ‰§è¡Œç¤ºä¾‹æ–¹æ¡ˆéƒ¨åˆ†ä¸­è¯¦ç»†ä»‹ç»çš„æ­¥éª¤ï¼‰

```java
package com.blog.junitTests;

import java.util.concurrent.TimeUnit;

import org.junit.After;
import org.junit.Before;
import org.junit.Test;
import org.openqa.selenium.By;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.WebElement;
import org.openqa.selenium.firefox.FirefoxDriver;

public class ScreenshotTest {
  //Declaring variables
  private WebDriver driver; 
  private String baseUrl;
  private String testCaseName = "ScreenshotTest";

  @Before
  public void setUp() throws Exception{
    // Selenium version 3 beta releases require system property set up
    System.setProperty("webdriver.gecko.driver", "E:\\Softwares\\"
        + "Selenium\\geckodriver-v0.10.0-win64\\geckodriver.exe");
    // Create a new instance for the class FirefoxDriver
    // that implements WebDriver interface
    driver = new FirefoxDriver();
    // Implicit wait for 5 seconds
    driver.manage().timeouts().implicitlyWait(5, TimeUnit.SECONDS);
    // Assign the URL to be invoked to a String variable
    baseUrl = "https://accounts.google.com/SignUp";
  }

  @Test
  public void testPageTitle() throws Exception{
    // Open baseUrl in Firefox browser window
    driver.get(baseUrl);
    // Locate First Name text box by id and
    // assign it to a variable of type WebElement
    WebElement firstName = driver.findElement(By.id("firstName"));
    // Clear the default placeholder or any value present
    firstName.clear();
    // Enter/type the value to the text box
    firstName.sendKeys("fname01");
    // Locate last name text box by name
    WebElement lastName = driver.findElement(By.name("lastName"));
    // Clear and enter a value
    lastName.clear();
    lastName.sendKeys("lname01");
    //Take a screenshot
    SaveScreenshot.capture(testCaseName, driver);
  }

   @After
    public void tearDown() throws Exception{
    // Close the Firefox browser
    driver.close();
  }
}
```

ä¸ºæ¯è¡Œä»£ç æä¾›äº†æ³¨é‡Šï¼Œå› æ­¤å®ƒæ˜¯ä¸è¨€è‡ªæ˜çš„ã€‚

![Eclipse output](img/d9bba1da5599720cb4111735fe851a62.png)

åœ¨ Eclipse IDE ä¸­ï¼Œâ€œJUnitâ€çª—æ ¼æ¸…æ¥šåœ°æ˜¾ç¤ºäº†æµ‹è¯•ç”¨ä¾‹â€œ`ScreenshotTest.java`â€å·²é€šè¿‡ï¼Œå¹¶ä¸”æ§åˆ¶å°æ²¡æœ‰é”™è¯¯ã€‚

å¦‚ä»£ç ä¸­æ‰€æŒ‡å®šï¼Œå±å¹•å¿«ç…§ä»¥ä¸Šè¿°æ ¼å¼çš„åç§°ä¿å­˜åœ¨â€œ`E:/Selenium/screenshots`â€è·¯å¾„ä¸­ã€‚

![Saved Screenshot](img/a83607c72020b85243e2b2f56815046b.png)

è¿™æ˜¯æ•è·çš„å±å¹•æˆªå›¾ï¼Œ

![Captured Screenshot](img/09ae5e35e176df55907d645952dba8b3.png)

ç°åœ¨æ˜¯æ—¶å€™åœ¨æ‚¨çš„æµ‹è¯•è¿‡ç¨‹ä¸­å®ç°è¿™ä¸€ç‚¹å¹¶ä¸ºè‡ªå·±å¯è§†åŒ–é­”æœ¯äº†ã€‚

ç¥å±å¹•æˆªå›¾æ„‰å¿«ï¼ğŸ˜‰